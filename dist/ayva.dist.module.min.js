var __webpack_modules__={570:(e,t,o)=>{o.d(t,{Z:()=>h});var s=o(336);var r=o(465);const a={validateMovements(e,t,o){const s={};let a=!1,i=!1;e&&e.length||(0,r.bG)("Must supply at least one movement."),e.forEach((e=>{e&&"object"==typeof e||(0,r.bG)(`Invalid movement: ${e}`);const n=t=>(0,r.bG)(`Invalid value for parameter '${t}': ${e[t]}`),c=(0,r.e$)(e,"to"),h=(0,r.e$)(e,"speed"),p=(0,r.e$)(e,"duration"),u=(0,r.e$)(e,"value"),m=e.axis||o;if(m||(0,r.bG)("No default axis configured. Must specify an axis for each movement."),(0,r.e$)(e,"axis")&&("string"==typeof e.axis&&e.axis.trim()&&t[e.axis]||n("axis")),c){let o=!1;o="boolean"===t[m].type?"boolean"!=typeof e.to:!Number.isFinite(e.to)||e.to<0||e.to>1,o&&n("to")}else u||(0,r.bG)("Must provide a 'to' property or 'value' function.");h&&p&&(0,r.bG)("Cannot supply both speed and duration."),(h||p)&&(a=!0,h&&(!Number.isFinite(e.speed)||e.speed<=0)?n("speed"):p&&(!Number.isFinite(e.duration)||e.duration<=0)&&n("duration")),h&&!c&&(0,r.bG)("Must provide a target position when specifying speed."),u&&"function"!=typeof e.value&&(0,r.bG)("'value' must be a function."),(0,r.e$)(e,"sync")&&("string"==typeof e.sync&&e.sync.trim()||n("sync"),((0,r.e$)(e,"speed")||(0,r.e$)(e,"duration"))&&(0,r.bG)(`Cannot specify a speed or duration when sync property is present: ${e.axis}`)),"boolean"!==t[m].type?i=!0:((0,r.e$)(e,"speed")&&(0,r.bG)(`Cannot specify speed for boolean axes: ${m}`),(0,r.e$)(e,"duration")&&c&&!u&&(0,r.bG)("Cannot specify a duration for a boolean axis movement with constant value.")),s[m]&&(0,r.bG)(`Duplicate axis movement: ${m}`),s[m]=e,t[m].alias&&(s[t[m].alias]=e)})),e.forEach((e=>{let t=e;const o=e.axis;for(;(0,r.e$)(t,"sync");)s[t.sync]||(0,r.bG)(`Cannot sync with axis not specified in movement: ${t.axis} -> ${t.sync}`),t=s[t.sync],t.sync===o&&(0,r.bG)("Sync axes cannot form a cycle.")})),!a&&i&&(0,r.bG)("At least one movement must have a speed or duration.")},validateAxisConfig(e){e&&"object"==typeof e||(0,r.bG)(`Invalid configuration object: ${e}`);const t={name:"string",type:"string",alias:"string",max:"number",min:"number"},o=["name","type"].filter((t=>void 0===e[t]||null===e[t])).sort();o.length&&(0,r.bG)(`Configuration is missing properties: ${o.join(", ")}`);const s=[];Object.keys(t).forEach((o=>{const r=e[o];null!=r&&(typeof r!==t[o]?s.push(o):"min"===o||"max"===o?(!Number.isFinite(r)||r<0||r>1)&&s.push(o):"alias"!==o&&"name"!==o||/^[a-zA-Z]+[a-zA-Z0-9]*$/.test(r)||s.push(o))}));let{defaultValue:a}=e;if(null!=a?"boolean"===e.type?"boolean"!=typeof a&&s.push("defaultValue"):(!Number.isFinite(a)||a<0||a>1)&&s.push("defaultValue"):a="boolean"!==e.type&&("auxiliary"===e.type?0:.5),s.length){const t=s.sort().map((t=>`${t} = ${e[t]}`)).join(", ");(0,r.bG)(`Invalid configuration parameter(s): ${t}`)}-1===["linear","rotation","auxiliary","boolean"].indexOf(e.type)&&(0,r.bG)(`Invalid type. Must be linear, rotation, auxiliary, or boolean: ${e.type}`);const i={...e,defaultValue:a,max:e.max||1,min:e.min||0,value:a,lastValue:a};return(i.max===i.min||i.min>i.max)&&(0,r.bG)(`Invalid configuration parameter(s): max = ${i.max}, min = ${i.min}`),i},validateMotionParameters({from:e,to:t,phase:o,ecc:s,bpm:a,shift:i}){if(!((0,r.BP)(e,0,1)&&(0,r.BP)(t,0,1)&&(0,r.BP)(o)&&(0,r.BP)(s)&&(0,r.BP)(a)&&a>0&&(0,r.BP)(i)))throw new Error(`One or more motion parameters are invalid (${e}, ${t}, ${o}, ${s}, ${a}, ${i})`)}},i={name:"SR6",defaultAxis:"L0",axes:[{name:"L0",type:"linear",alias:"stroke"},{name:"L1",type:"linear",alias:"surge"},{name:"L2",type:"linear",alias:"sway"},{name:"R0",type:"rotation",alias:"twist"},{name:"R1",type:"rotation",alias:"roll"},{name:"R2",type:"rotation",alias:"pitch"},{name:"A0",alias:"valve",type:"auxiliary"},{name:"A1",alias:"suck",type:"auxiliary"},{name:"A2",alias:"lube",type:"auxiliary",resetOnStop:!0},{name:"V0",alias:"vibe0",type:"auxiliary",resetOnStop:!0},{name:"V1",alias:"vibe1",type:"auxiliary",resetOnStop:!0}]};var n=o(697);class c{#e=[];#t={};#o=50;#s=new Set;#r=1;#a=1;#i=null;#n=!1;#c;#h=new Set;#p=new Set;defaultRamp=c.RAMP_COS;static get precision(){return 10}static get maxFrequency(){return 250}get performing(){return this.#n}get axes(){const e={};return Object.keys(this.#t).forEach((t=>{e[t]=this.getAxis(t)})),e}get frequency(){return this.#o}set frequency(e){if(!(0,r.BP)(e,1,c.maxFrequency))throw new Error(`Invalid frequency ${e}. Frequency must be a number between 1 and ${c.maxFrequency}.`);this.#o=e}get period(){return this.#u}get#u(){return 1/this.#o}constructor(e){(0,r.w6)(this,"$",{}),e&&this.#m(e),"undefined"==typeof Worker?this.#c={sleep:e=>new Promise((t=>{setTimeout(t,1e3*e)})),now:()=>performance.now()/1e3}:this.#c=new class{#f;#l={};#d=1;constructor(){this.#f=new Worker(this.#_((function(){onmessage=function(e){const{id:t,delay:o}=e.data;setTimeout((()=>{postMessage(t)}),1e3*o)}}))),this.#f.onmessage=({data:e})=>{const t=e;this.#l[t](),delete this.#l[t]}}sleep(e){return new Promise((t=>{const o=this.#d++;this.#l[o]=t,this.#f.postMessage({id:o,delay:e})}))}now(){return performance.now()/1e3}#_(e){const t=new Blob([`(${e.toString()})()`],{type:"text/javascript"});return URL.createObjectURL(t)}}}defaultConfiguration(){return this.#m(i),this}getTimer(){return this.#c}async do(e){this.#b();const t=this.#a++;for(this.#i=t;this.#n;)await this.sleep();this.#n=!0;const o=this.#v(e);for(;this.#i===t&&!o.complete;)try{await o.perform(this),await this.ready()}catch(e){console.error("Error performing behavior:",e?.stack);break}return this.#n=!1,this.#i===t&&(this.#i=null,!0)}move(...e){if(!this.#e||!this.#e.length)throw new Error("No output devices have been added.");return a.validateMovements(e,this.#t,this.defaultAxis),this.#g(...e)}ready(){return this.#h.size||this.#s.size?new Promise((e=>{this.#p.add(e)})):this.sleep()}moveBuilder(){return new s.Z(this)}async home(e=.5){const t=this.#y().map((t=>{const o={axis:t.name,to:t.defaultValue};return"boolean"!==t.type&&(o.speed=e),o}));return t.length?this.move(...t):(console.warn("No linear or rotation axes configured."),Promise.resolve(!1))}stop(){this.#b()}sleep(e){let t;const o=new Promise((e=>{this.#h.add(e),t=e}));return Promise.any([this.#c.sleep(e).then((()=>!0)),o.then((()=>!1))]).finally((()=>{this.#h.delete(t),this.#x()}))}configureAxis(e){const t=a.validateAxisConfig(e),o=this.#t[e.name];if(o&&(t.value=o.value,t.lastValue=o.lastValue,delete this.#t[o.alias],delete this.$[o.alias]),this.#t[e.name]=t,this.#w(e.name),e.alias){if(this.#t[e.alias])throw new Error(`Alias already refers to another axis: ${e.alias}`);this.#t[e.alias]=t,this.#w(e.alias)}}getAxis(e){const t=this.#t[e];if(t){const e={};return Object.keys(t).forEach((o=>{(0,r.w6)(e,o,t[o])})),e}}getAxes(){return this.#y().map((e=>({name:e.name,alias:e.alias,type:e.type,defaultValue:e.defaultValue,max:e.max,min:e.min,value:e.value,lastValue:e.lastValue,resetOnStop:e.resetOnStop})))}updateLimits(e,t,o){const s=e=>!Number.isFinite(e)||e<0||e>1;if(s(t)||s(o)||t===o)throw new Error(`Invalid limits: min = ${t}, max = ${o}`);if(!this.#t[e])throw new Error(`Invalid axis: ${e}`);this.#t[e].min=Math.min(t,o),this.#t[e].max=Math.max(t,o)}setValues(e){const t=Object.entries(e).map((([e,t])=>({axis:e,value:t})));this.#R(t)}addOutput(...e){this.addOutputDevice(...e)}getOutput(){return this.getOutputDevices()}removeOutput(e){this.removeOutputDevice(e)}addOutputDevice(...e){const t=e.map((e=>{const t=e&&e.write&&e.write instanceof Function;if(!(t||e instanceof Function))throw new Error(`Invalid device: ${e}`);return t?e:{write:e}}));this.#e.push(...t)}getOutputDevices(){return[...this.#e]}removeOutputDevice(e){const t=this.#e.indexOf(e);-1!==t&&this.#e.splice(t,1)}async#g(...e){const t=this.#r++;for(this.#s.add(t);this.#s.has(t)&&this.#s.values().next().value!==t;)await this.sleep();return!!this.#s.has(t)&&this.#L(t,e).finally((()=>{this.#s.delete(t),this.#x()}))}#b(){this.#i=null,this.#s.clear(),this.#h.forEach((e=>e()));const e={};this.#y().forEach((t=>{t.resetOnStop&&(e[t.name]=t.defaultValue)})),Object.keys(e).length&&this.setValues(e)}#w(e){Object.defineProperty(this.$,e,{value:(...t)=>this.moveBuilder()[e](...t),writeable:!1,configurable:!0,enumerable:!0}),Object.defineProperty(this.$[e],"value",{get:()=>this.#t[e].value,set:t=>{const{type:o}=this.#t[e];if("boolean"!==o&&!(0,r.BP)(t,0,1))throw new Error(`Invalid value: ${t}`);this.#R([{axis:e,value:t}])}}),Object.defineProperty(this.$[e],"lastValue",{get:()=>this.#t[e].lastValue}),Object.defineProperty(this.$[e],"defaultValue",{get:()=>this.#t[e].defaultValue}),Object.defineProperty(this.$[e],"min",{get:()=>this.#t[e].min}),Object.defineProperty(this.$[e],"max",{get:()=>this.#t[e].max})}#m(e){this.name=e.name,this.defaultAxis=e.defaultAxis,this.#o=e.frequency||this.#o,e.axes&&e.axes.forEach((e=>{this.configureAxis(e)}))}#v(e){return"function"!=typeof e||e instanceof n.Z?e:(0,r.Af)(e)?new n.Z(e):{perform:e}}#A(e){for(const t of this.#e)t.write(e)}async#L(e,t){const o=this.#M(t),{duration:s,stepCount:r}=this.#P(o),a=o.filter((e=>!e.parameters.stepCount)),i=o.filter((e=>!!e.parameters.stepCount));this.#k(a,0);let n=0;const c=this.#c.now();if(r)for(let t=0;t<r;t++){const o=i.filter((e=>t<e.parameters.stepCount));if(this.#k(o,t),n=await this.#$(t,r,s,c,n),!this.#s.has(e))return!1}else await this.sleep(this.#u);return!0}async#$(e,t,o,s,r){const a=e=>Math.max(e,1/c.maxFrequency);if(e===t-1){const e=this.#c.now()-s,t=Math.min(Math.max(o-e,0),this.#u);await this.sleep(a(t))}else await this.sleep(a(this.#u-r));return this.#c.now()-s-(e+1)*this.#u}#k(e,t){const o=e.map((e=>this.#E(e,t)));this.#R(o)}#E(e,t){const o=t*this.#u,{parameters:s,valueProvider:a}=e,{duration:i}=s,n=a({...s,time:o,index:t,period:this.#u,frequency:this.#o,currentValue:this.#t[s.axis].value,x:Math.min(1,(t+1)/(i*this.#o))}),h=null!=n;return!this.#S(n)&&h&&console.warn(`Invalid value provided: ${n}`),{axis:s.axis,value:Number.isFinite(n)?(0,r.uZ)((0,r.NM)(n,c.precision),0,1):n}}#R(e){const t=e.filter((({value:e})=>this.#S(e))).map((({axis:e,value:t})=>this.#O(e,t)));t.length&&(this.#A(`${t.join(" ")}\n`),e.forEach((({axis:e,value:t})=>{this.#t[e].lastValue=this.#t[e].value,this.#t[e].value=t})))}#S(e){return Number.isFinite(e)||"boolean"==typeof e}#O(e,t){let o;if("boolean"==typeof t)o=t?"9999":"0000";else{const{min:s,max:a}=this.#t[e],i=(a-s)*(0,r.NM)(.9999*t,4)+s;o=`${(0,r.uZ)((0,r.NM)(1e4*i),0,9999)}`.padStart(4,"0")}return`${this.#t[e].name}${o}`}#M(e){const{parameterObjects:t,maxDuration:o}=this.#T(e);return this.#B(t,o),t.map((e=>{const t={};return(0,r.e$)(e,"value")?t.valueProvider=e.value:"boolean"===this.#t[e.axis].type?t.valueProvider=()=>e.to:e.to!==e.from?t.valueProvider=this.defaultRamp:t.valueProvider=()=>{},delete e.sync,delete e.value,t.parameters=e,t}))}#T(e){let t=0;const o=e.map((e=>{const o=e.axis||this.defaultAxis,s={...e,axis:o,from:this.#t[o].value,period:this.#u};if((0,r.e$)(e,"to")){const t=e.to-s.from,o=Math.abs(t);(0,r.e$)(e,"duration")?s.speed=(0,r.NM)(o/e.duration,c.precision):(0,r.e$)(e,"speed")&&(s.duration=(0,r.NM)(o/s.speed,c.precision)),s.direction=t>0?1:t<0?-1:0}return(0,r.e$)(s,"duration")&&(t=Math.max(s.duration,t)),s}));return{maxDuration:t,parameterObjects:o}}#B(e,t){const o=e.reduce(((e,t)=>(e[t.axis]=t,this.#t[t.axis].alias&&(e[this.#t[t.axis].alias]=t),e)),{});e.forEach((e=>{if((0,r.e$)(e,"sync")){let s=e;for(;(0,r.e$)(s,"sync");)s=o[s.sync];e.duration=s.duration||t,(0,r.e$)(e,"to")&&(e.speed=(0,r.NM)(Math.abs(e.to-e.from)/e.duration,c.precision))}else(0,r.e$)(e,"duration")||"boolean"===this.#t[e.axis].type||(e.duration=t);(0,r.e$)(e,"duration")&&(e.stepCount=Math.ceil(e.duration*this.#o))}))}#P(e){let t=0,o=0;return e.forEach((e=>{const s=e.parameters.stepCount,r=e.parameters.duration;s&&(t=Math.max(s,t)),r&&(o=Math.max(r,o))})),{duration:o,stepCount:t}}#y(){const e={};return Object.values(this.#t).forEach((t=>{e[t.name]=t})),Object.values(e).sort((function(e,t){return e.name>t.name?1:-1}))}#x(){if(0===this.#h.size&&0===this.#s.size&&this.#p.size){for(const e of this.#p)e();this.#p.clear()}}static ramp(e){return t=>{const{from:o,to:s}=t;return o+(s-o)*e(t)}}static RAMP_LINEAR(e){return c.ramp((({x:e})=>e))(e)}static RAMP_COS(e){return c.ramp((({x:e})=>-Math.cos(Math.PI*e)/2+.5))(e)}static RAMP_PARABOLIC(e){return c.ramp((({x:e})=>e*e))(e)}static RAMP_NEGATIVE_PARABOLIC(e){return c.ramp((({x:e})=>1-(e-1)**2))(e)}static tempestMotion(e,t,o=0,s=0,r=60,a=0){const i="object"==typeof e?e:{from:e,to:t,phase:o,ecc:s,bpm:r,shift:a};return c.#I(i)}static#I(e){e={from:0,to:1,phase:0,ecc:0,shift:0,bpm:60,...e},a.validateMotionParameters(e);const{from:t,to:o,phase:s,ecc:r,bpm:i,shift:n}=e,h=2*Math.PI*i/60,p=.5*(o-t),u=.5*(o+t),m=({index:e,frequency:t})=>{const o=(e+1)*h/t+.5*Math.PI*s+n;return u-p*Math.cos(o+r*Math.sin(o))};return c.#Z(m,t,o,s,r,i),m}static parabolicMotion(e,t,o=0,s=0,r=60,a=0){const i="object"==typeof e?e:{from:e,to:t,phase:o,ecc:s,bpm:r,shift:a};return c.#F(i)}static#F(e){e={from:0,to:1,phase:0,ecc:0,shift:0,bpm:60,...e},a.validateMotionParameters(e);const{from:t,to:o,phase:s,ecc:r,bpm:i,shift:n}=e,{sin:h,PI:p}=Math,u=2*p*i/60,m=o-t,f=o,l=({index:e,frequency:t})=>{const o=(e+1)*u/t+.5*p*s+n,a=(o%(i=2*p)+i)%i/p-1+r/p*h(o);var i;return f-m*a*a};return c.#Z(l,t,o,s,r,i),l}static linearMotion(e,t,o=0,s=0,r=60,a=0){const i="object"==typeof e?e:{from:e,to:t,phase:o,ecc:s,bpm:r,shift:a};return c.#j(i)}static#j(e){e={from:0,to:1,phase:0,ecc:0,shift:0,bpm:60,...e},a.validateMotionParameters(e);const{from:t,to:o,phase:s,ecc:r,bpm:i,shift:n}=e,{abs:h,sin:p,PI:u}=Math,m=2*u*i/60,f=o-t,l=o,d=({index:e,frequency:t})=>{const o=(e+1)*m/t+.5*u*s+n,a=(o%(i=2*u)+i)%i/u-1+r/u*p(o);var i;return l-f*h(a)};return c.#Z(d,t,o,s,r,i),d}static#Z(e,t,o,s,a,i){(0,r.w6)(e,"from",t),(0,r.w6)(e,"to",o),(0,r.w6)(e,"phase",s),(0,r.w6)(e,"ecc",a),(0,r.w6)(e,"bpm",i)}static blendMotion(e,t,o){return(...s)=>(0,r.NM)((1-o)*e(...s)+o*t(...s),c.precision)}static get defaultConfiguration(){return{...i}}static map(e,t,o,s=0,r=1){return(e-t)*(r-s)/(o-t)+s}}const h=c},321:(e,t,o)=>{o.d(t,{Z:()=>c});var s=o(570),r=o(697),a=o(465),i=o(319);class n extends r.Z{#C;#q;#V;#N;#D;get speed(){return this.#V}get top(){return this.#C}get bottom(){return this.#q}get duration(){return this.#N}static get DEFAULT_CONFIG(){return{top:1,bottom:0,speed:1,shape:s.Z.RAMP_COS,relativeSpeeds:[1,1],suck:null,twist:null,pitch:null}}constructor(e=0,t=1,o=1,r=s.Z.RAMP_COS){let a;super(),a="object"!=typeof e||e instanceof Array?{top:t,bottom:e,speed:o,shape:r}:e,this.#G(a)}*generate(e){const{value:t,lastValue:o}=e.$.stroke,{target:s,shape:r,direction:i,relativeSpeed:n}=this.#U(t,o),c=this.#V*n,h={to:s,value:r};void 0!==this.#D.speed?(h.speed=c,this.#V=this.#D.speed.next()):(h.duration=this.#N/n,this.#N=this.#D.duration.next());const p=[h];this.#D.twist&&p.push(this.#W("twist",{direction:i,value:t,target:s,ayva:e,speed:void 0!==this.#D.speed?c:Math.abs(s-t)/h.duration})),this.#D.pitch&&p.push(this.#W("pitch",{direction:i,value:t,target:s,ayva:e,speed:void 0!==this.#D.speed?c:Math.abs(s-t)/h.duration})),(0,a.BP)(this.#D.suck,0,1)&&(e.$.suck.value=this.#D.suck),yield p}#G(e){const t=n.DEFAULT_CONFIG;(0,a.e$)(e,"duration")&&delete t.speed;const o={...t,...e};this.#z(o),o.top=i.Z.createFrom(o.top),o.bottom=i.Z.createFrom(o.bottom),o.relativeSpeeds=i.Z.createFrom(o.relativeSpeeds),(0,a.e$)(o,"duration")?o.duration=i.Z.createFrom(o.duration):o.speed=i.Z.createFrom(o.speed);const{shape:s}=o;o.shape=s instanceof Array?new i.Z((e=>s[e%s.length])):new i.Z((()=>s)),this.#D=o,this.#C=this.#D.top.next(),this.#q=this.#D.bottom.next(),void 0!==this.#D.speed?this.#V=this.#D.speed.next():this.#N=this.#D.duration.next()}#W(e,{direction:t,value:o,target:r,speed:a,ayva:i}){const{frequency:n}=i,c=("up"===t?0:2)+(this.#D[e].phase||0),h=this.#D[e].ecc||0,p=60*a/(2*Math.abs(o-r)),u=s.Z.tempestMotion(this.#D[e].from,this.#D[e].to,c,h,p),m=u({index:-1,frequency:n});return Math.abs(m-i.$[e].value)>.05?{axis:e,to:s.Z.tempestMotion(this.#D[e].from,this.#D[e].to,c+2,h,p)({index:-1,frequency:n}),value:s.Z.RAMP_COS}:{axis:e,value:u}}#U(e,t){const o=e-t>=0,s=this.#D.shape.index%2==0?"up":"down",r=this.#D.relativeSpeeds.index%2==0?"up":"down";let a,i;return e<=this.#q||e<this.#C&&!o?(i="up",a=this.#C,this.#C=this.#D.top.next(),"down"===s&&this.#D.shape.next(),"down"===r&&this.#D.relativeSpeeds.next()):(i="down",a=this.#q,this.#q=this.#D.bottom.next(),"up"===s&&this.#D.shape.next(),"up"===r&&this.#D.relativeSpeeds.next()),{target:a,shape:this.#D.shape.next(),direction:i,relativeSpeed:this.#D.relativeSpeeds.next()}}#z(e){const t=(e,t)=>{throw new Error(`Invalid stroke ${e}: ${t}`)};if((0,a.BP)(e.bottom,0,1)||"function"==typeof e.bottom||e.bottom instanceof Array||t("bottom",e.bottom),(0,a.BP)(e.top,0,1)||"function"==typeof e.top||e.top instanceof Array||t("top",e.top),e.bottom===e.top)throw new Error(`Invalid stroke range specified: (${e.bottom}, ${e.top})`);if((0,a.e$)(e,"speed")&&(0,a.e$)(e,"duration"))throw new Error("Cannot specify both a speed and duration");if(!(0,a.e$)(e,"speed")||(0,a.BP)(e.speed)&&!(e.speed<=0)||"function"==typeof e.speed||e.speed instanceof Array||t("speed",e.speed),!(0,a.e$)(e,"duration")||(0,a.BP)(e.duration)&&!(e.duration<=0)||"function"==typeof e.duration||e.duration instanceof Array||t("duration",e.duration),"function"==typeof e.shape||e.shape instanceof Array||t("shape",e.shape),!(0,a.e$)(e,"relativeSpeeds")||e.relativeSpeeds instanceof Array||t("relative speeds",e.relativeSpeeds),["twist","pitch"].forEach((o=>{"object"!=typeof e[o]&&t(o,e[o]),e[o]&&((0,a.BP)(e[o].from,0,1)||t(`${o} from`,e[o].from),(0,a.BP)(e[o].to,0,1)||t(`${o} to`,e[o].to),(0,a.e$)(e[o],"phase")&&!(0,a.BP)(e[o].phase)&&t(`${o} phase`,e[o].phase))})),e.shape instanceof Array){if(!e.shape.length)throw new Error("Missing stroke shape.");if(e.shape.length%2!=0)throw new Error("Must specify an even number of stroke shapes.");e.shape.forEach((e=>{"function"!=typeof e&&t("shape",e)}))}if(e.relativeSpeeds instanceof Array){if(e.relativeSpeeds.length%2!=0)throw new Error("Must specify an even number of relative speeds.");e.relativeSpeeds.forEach((e=>{(!(0,a.BP)(e)||e<=0)&&t("relative speed",e)}))}(0,a.e$)(e,"suck")&&!(0,a.BP)(e.suck,0,1)&&null!==e.suck&&t("suck",e.suck)}}const c=n},697:(e,t,o)=>{o.d(t,{Z:()=>n});const s=class extends Function{constructor(){return super("...args","return this.__bound__.__call__(...args)"),this.__bound__=Function.prototype.bind.call(this,this),this.__bound__}__call__(...e){throw new Error("__call__ not implemented.")}};var r=o(336),a=o(570);class i extends s{#J;#K=!1;#X=null;#H;#Q;#Y;get ayva(){return this.#X}constructor(e){if(super(),e){if("GeneratorFunction"!==e.constructor.name)throw Error(`Not a generator function: ${e}`);this.generate=e}}*start(e){}*generate(e){throw new Error("generate() not implemented.")}*iterated(e,t=1){for(let o=0;o<t;o++)yield*this.generate(e)}perform(e=this.#X){const t=this.next(e);return t?Array.isArray(t)?e.move(...t):Number.isFinite(t)&&t>=0?e.ready().then((()=>e.sleep(t))):t instanceof r.Z?t.execute():t instanceof Promise?t:e.move(t):Promise.resolve()}bind(e){return this.unbind(),this.#X=e,this.#H=this.start,this.#Q=this.generate,this.#Y=this.iterated,this.start=this.start.bind(this,e),this.generate=this.generate.bind(this,e),this.iterated=this.iterated.bind(this,e),this}unbind(){this.#X&&(this.#X=null,this.start=this.#H,this.generate=this.#Q,this.iterated=this.#Y)}next(e=this.#X){this.#J&&!this.#K||(this.#J=this.generate(e),this.#K=!1);const{value:t,done:o}=this.#J.next();return this.#K=o,o?null:t}__call__(...e){const t=this.#X?e[0]:e[1],o=this.#X||e[0],s=Number.isFinite(t)&&t>=1?t:void 0;if(void 0!==o&&!(o instanceof a.Z))throw new TypeError(`Invalid Ayva instance: ${o}`);return this.#X?s?this.iterated(s):this.generate():s?this.iterated(o,s):this.generate(o)}[Symbol.iterator](){return this.generate()}}const n=i},590:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _generator_behavior_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(697),_util_script_whitelist_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(424);class ScriptBehavior extends _generator_behavior_js__WEBPACK_IMPORTED_MODULE_0__.Z{#ee;#te;constructor(e,t={}){super(),this.#ee={..._util_script_whitelist_js__WEBPACK_IMPORTED_MODULE_1__,...t},this.#te=e.replace(/["'`\\]/g,(e=>`\\${e}`))}*generate(e){const t=this.#oe(e);for(;!this.complete;)yield*t(e),yield}#oe(){const scopeValues=[];let sandboxFunction="new Function(";for(const e in this.#ee)sandboxFunction+=`"${e}", `,scopeValues.push(this.#ee[e]);for(const e in globalThis)Object.prototype.hasOwnProperty.call(this.#ee,e)||(sandboxFunction+=`"${e}", `);sandboxFunction+='"eval", "Function", ',sandboxFunction+=`\`\n      return (function*(ayva) { \n        ${this.#te} \n      }).bind(this);\`);`;try{const sandbox=eval(sandboxFunction);return sandbox.call(this,...scopeValues)}catch(e){throw new SyntaxError("Invalid AyvaScript.")}}}const __WEBPACK_DEFAULT_EXPORT__=ScriptBehavior},824:(e,t,o)=>{o.d(t,{Z:()=>u});var s=o(697),r=o(570),a=o(319);const i={"down-forward":{L0:{from:0,to:1,phase:0,ecc:.5},L1:{from:.8,to:.2,phase:1,ecc:.8},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.2,to:.8,phase:1,ecc:.8}},"down-backward":{L0:{from:0,to:1,phase:0,ecc:.5},L1:{from:.2,to:.8,phase:1,ecc:.8},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.8,to:.2,phase:1,ecc:.8}},"back-thrust-down":{L0:{from:0,to:.7,phase:0,ecc:.5},L1:{from:1,to:0,phase:0,ecc:.5},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.4,to:1,phase:0,ecc:.5}},"back-thrust-down-swirl":{L0:{from:0,to:.7,phase:0,ecc:.5},L1:{from:.9,to:.1,phase:0,ecc:.5},L2:{from:.8,to:.2,phase:1,ecc:.5},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.8,to:.2,phase:1,ecc:.5},R2:{from:.5,to:1,phase:0,ecc:.5}},"thrust-forward":{L0:{from:0,to:.5,phase:0,ecc:.5},L1:{from:.2,to:1,phase:0,ecc:.5},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.5,to:1,phase:0,ecc:.5}},"thrust-forward-swirl":{L0:{from:0,to:.5,phase:0,ecc:.5},L1:{from:.2,to:1,phase:0,ecc:.5},L2:{from:.8,to:.2,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.8,to:.2,phase:1,ecc:0},R2:{from:.5,to:1,phase:0,ecc:.5}},"lean-forward-thrust-down":{L0:{from:0,to:.7,phase:0,ecc:.5},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:1,to:0,phase:0,ecc:.5}},"lean-forward-thrust-down-swirl":{L0:{from:0,to:.7,phase:0,ecc:.5},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:.8,to:.2,phase:1,ecc:.5},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.8,to:.2,phase:1,ecc:.5},R2:{from:1,to:0,phase:0,ecc:.5}},"diagonal-down-back":{L0:{from:0,to:.5,phase:0,ecc:.2},L1:{from:1,to:.2,phase:0,ecc:.2},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:1,to:0,phase:1,ecc:.6}},"diagonal-down-forward":{L0:{from:0,to:.5,phase:0,ecc:.2},L1:{from:0,to:.8,phase:0,ecc:.2},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:0,to:1,phase:1,ecc:.6}},"orbit-tease":{L0:{from:.8,to:1,phase:0,ecc:.3},L1:{from:.9,to:.1,phase:0,ecc:-.3},L2:{from:.1,to:.9,phase:1,ecc:-.3},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.1,to:.9,phase:1,ecc:-.3},R2:{from:.1,to:.9,phase:0,ecc:-.3}},"left-right-tease":{L0:{from:.9,to:.9,phase:0,ecc:0},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:0,to:1,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:1,to:0,phase:1,ecc:0},R2:{from:.5,to:.5,phase:0,ecc:0}},"forward-back-tease":{L0:{from:.9,to:.9,phase:0,ecc:0},L1:{from:0,to:1,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:0,to:1,phase:1,ecc:0}},"vortex-tease":{L0:{from:.8,to:1,phase:0,ecc:.3},L1:{from:.6,to:.4,phase:0,ecc:0},L2:{from:.4,to:.6,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.9,to:.1,phase:1,ecc:0},R2:{from:.9,to:.1,phase:0,ecc:0}},"swirl-tease":{L0:{from:.5,to:1,phase:0,ecc:0},L1:{from:1,to:.3,phase:0,ecc:0},L2:{from:1,to:0,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.9,to:.1,phase:1,ecc:0},R2:{from:.4,to:1,phase:0,ecc:0}},"forward-back-grind":{L0:{from:0,to:0,phase:0,ecc:0},L1:{from:.3,to:.7,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:0,to:1,phase:.5,ecc:0}},"orbit-grind":{L0:{from:0,to:.3,phase:0,ecc:.3},L1:{from:0,to:.6,phase:0,ecc:-.3},L2:{from:.2,to:.8,phase:1,ecc:-.3},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.1,to:.9,phase:1,ecc:-.3},R2:{from:.9,to:.1,phase:0,ecc:-.3}},"short-low-roll-forward":{L0:{from:0,to:.5,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.4,to:.6,phase:1,ecc:0}},"short-low-roll-backward":{L0:{from:0,to:.5,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.6,to:.4,phase:1,ecc:0}},"short-mid-roll-forward":{L0:{from:.25,to:.75,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.4,to:.6,phase:1,ecc:0}},"short-mid-roll-backward":{L0:{from:.25,to:.75,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.6,to:.4,phase:1,ecc:0}},"short-high-roll-backward":{L0:{from:.5,to:1,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.4,to:.6,phase:1,ecc:0}},"short-high-roll-forward":{L0:{from:.5,to:1,phase:0,ecc:.25},L1:{from:.5,to:.5,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.6,to:.4,phase:1,ecc:0}},"long-stroke-1":{L0:{from:.1,to:.9,phase:0,ecc:.25},L1:{from:.8,to:.2,phase:1,ecc:.5},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.3,to:.7,phase:1,ecc:.2}},"long-stroke-2":{L0:{from:.1,to:.9,phase:0,ecc:.25},L1:{from:.2,to:.8,phase:1,ecc:.5},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.7,to:.3,phase:1,ecc:.2}},"long-stroke-3":{L0:{from:0,to:.7,phase:0,ecc:0},L1:{from:0,to:1,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:1,to:.3,phase:0,ecc:.5}},"long-stroke-4":{L0:{from:0,to:.7,phase:0,ecc:0},L1:{from:.6,to:.4,phase:0,ecc:0},L2:{from:.6,to:.4,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.7,to:.3,phase:1,ecc:0},R2:{from:.5,to:1,phase:0,ecc:.25}},"long-stroke-5":{L0:{from:0,to:.8,phase:0,ecc:0},L1:{from:.4,to:.6,phase:0,ecc:0},L2:{from:.4,to:.6,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.3,to:.7,phase:1,ecc:0},R2:{from:.5,to:1,phase:0,ecc:.25}},"grind-circular":{L0:{from:0,to:0,phase:0,ecc:0},L1:{from:.7,to:.3,phase:0,ecc:0},L2:{from:.3,to:.7,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.3,to:.7,phase:1,ecc:0},R2:{from:.3,to:.7,phase:0,ecc:0}},"grind-vortex":{L0:{from:0,to:0,phase:0,ecc:0},L1:{from:.7,to:.3,phase:0,ecc:0},L2:{from:.7,to:.3,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.7,to:.3,phase:1,ecc:0},R2:{from:.3,to:.7,phase:0,ecc:0}},"grind-forward-back":{L0:{from:0,to:.1,phase:0,ecc:0},L1:{from:0,to:1,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.6,to:.4,phase:0,ecc:0}},"grind-forward-back-phased":{L0:{from:0,to:.1,phase:0,ecc:0},L1:{from:0,to:1,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.3,to:.7,phase:1,ecc:0}},"grind-forward-back-tilt":{L0:{from:0,to:.2,phase:0,ecc:0},L1:{from:.2,to:.8,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.7,to:0,phase:0,ecc:0}},"grind-forward-tilt":{L0:{from:0,to:.2,phase:0,ecc:0},L1:{from:.3,to:.3,phase:0,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.1,to:.7,phase:0,ecc:0}},"tease-orbit-right":{L0:{from:.9,to:.9,phase:0,ecc:0},L1:{from:.7,to:.3,phase:0,ecc:0},L2:{from:.3,to:.7,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.1,to:.9,phase:1,ecc:0},R2:{from:.1,to:.9,phase:0,ecc:0}},"tease-orbit-left":{L0:{from:.9,to:.9,phase:0,ecc:0},L1:{from:.7,to:.3,phase:0,ecc:0},L2:{from:.7,to:.3,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.9,to:.1,phase:1,ecc:0},R2:{from:.1,to:.9,phase:0,ecc:0}},"tease-left-right-rock":{L0:{from:.8,to:.8,phase:0,ecc:0},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:.9,to:.1,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:1,to:0,phase:0,ecc:0},R2:{from:.5,to:.5,phase:0,ecc:0}},"tease-down-back":{L0:{from:.8,to:1,phase:0,ecc:0},L1:{from:.2,to:.8,phase:1,ecc:0},L2:{from:.5,to:.5,phase:0,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.5,to:.5,phase:0,ecc:0},R2:{from:.9,to:.3,phase:1,ecc:0}},"tease-back-swirl-right":{L0:{from:.7,to:.9,phase:0,ecc:0},L1:{from:.8,to:.2,phase:0,ecc:0},L2:{from:.2,to:.8,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.2,to:.8,phase:1,ecc:0},R2:{from:.3,to:1,phase:0,ecc:0}},"tease-back-swirl-left":{L0:{from:.7,to:.9,phase:0,ecc:0},L1:{from:.8,to:.2,phase:0,ecc:0},L2:{from:.8,to:.2,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.8,to:.2,phase:1,ecc:0},R2:{from:.3,to:1,phase:0,ecc:0}},"tease-up-down-circle-right":{L0:{from:.7,to:1,phase:0,ecc:0},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:.3,to:.7,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.3,to:.7,phase:1,ecc:0},R2:{from:.8,to:.8,phase:0,ecc:0}},"tease-up-down-circle-left":{L0:{from:.7,to:1,phase:0,ecc:0},L1:{from:.5,to:.5,phase:0,ecc:0},L2:{from:.7,to:.3,phase:1,ecc:0},R0:{from:.5,to:.5,phase:0,ecc:0},R1:{from:.7,to:.3,phase:1,ecc:0},R2:{from:.8,to:.8,phase:0,ecc:0}}};var n=o(465);class c extends s.Z{#se;#re;#ae;#c;#ie;#ne;get angle(){return this.#se}set angle(e){this.#se=e}get startAngle(){return this.#ne}set startAngle(e){this.#ne=e}get bpm(){return this.#re}get startTime(){return this.#ie}set startTime(e){this.#ie=e}get timer(){return this.#c}static#ce=36;static#he=JSON.parse(JSON.stringify(i));static set granularity(e){if(!(0,n.BP)(e,1,180))throw new Error(`Invalid granularity: ${e}`);c.#ce=e}static get granularity(){return c.#ce}static get DEFAULT_PARAMETERS(){return{from:0,to:1,phase:0,ecc:0,shift:0,noise:0,motion:r.Z.tempestMotion}}static get DEFAULT_TIMER(){return()=>performance.now()/1e3}static get library(){return JSON.parse(JSON.stringify(c.#he))}static computeTargetAngle(e,t){const o=Math.abs(e-t),s=Math.floor(o/Math.PI),r=(s+1)*Math.PI+t;return r===e?(s+2)*Math.PI+t:r}static update(e,t){c.#he[e]=JSON.parse(JSON.stringify(t))}static remove(e){delete c.#he[e]}static restoreLibrary(){c.#he=JSON.parse(JSON.stringify(i))}constructor(e,t=60,o=0,s=c.DEFAULT_TIMER,r=null){if(super(),"string"==typeof e){if(!(0,n.e$)(c.library,e))throw new Error(`No stroke named ${e} found.`);e=c.library[e]}(0,n.w6)(this,"axes",{}),Object.keys(e).forEach((t=>{this.#pe(e[t]),(0,n.w6)(this.axes,t,{}),Object.keys(e[t]).forEach((o=>{(0,n.w6)(this.axes[t],o,e[t][o])})),Object.keys(c.DEFAULT_PARAMETERS).forEach((o=>{(0,n.e$)(e[t],o)||(0,n.w6)(this.axes[t],o,c.DEFAULT_PARAMETERS[o])}));const{from:o,to:s}=this.axes[t];(0,n.w6)(this.axes[t],"$current",{from:o,to:s})})),this.#se=o,this.#ne=o,this.#ae=a.Z.createFrom(t),this.#re=this.#ae.next(),this.#c=s instanceof Function?{now:s}:s,this.#ie=r}*generate(e){this.#c?yield*this.#ue(e):yield*this.#me(e)}*start(e,t){const o=this.getStartMoves(e,t);yield o}getStartMoves(e,t){const o={};t&&((0,n.e$)(t,"speed")||(0,n.e$)(t,"duration"))||(o.speed=1);const s={};return[...Object.keys(this.axes).map((r=>{s[e.getAxis(r).name]=!0;const a=this.axes[r];return{axis:r,to:a.motion(a.$current.from,a.$current.to,a.phase,a.ecc,this.#re,a.shift+this.#se)({index:-1,frequency:e.frequency}),...o,...t}})),...e.getAxes().filter((e=>!s[e.name])).map((e=>{const s={axis:e.name,to:e.defaultValue,...o,...t};return"boolean"===e.type&&(delete s.speed,delete s.duration),s}))]}transition(e,t=60,o=1,s=null,r=null){return new h(e,t,this,o,s,r)}*#ue(e){this.#ie=this.#ie||this.#c.now();const t=c.computeTargetAngle(this.#se,this.#ne);for(;this.#se<t;){const t=2*(this.#c.now()-this.#ie)*Math.PI/60,o=this.#re*t,s=this.#se;this.#se=this.#ne+o,this.#fe(e,this.#se-s);const r=this.#re;this.#re=this.#ae.next(),this.#ne+=(r-this.#re)*t,yield e.period}}*#me(){const{granularity:e}=c,t=this.#se;for(let o=0;o<e;o++)yield this.#le(o),this.#se=t+(o+1)*Math.PI/e,this.#re=this.#ae.next()}#fe(e,t){const o={};Object.keys(this.axes).forEach((s=>{const r=this.axes[s];o[s]=r.motion(r.$current.from,r.$current.to,r.phase,r.ecc,this.#re,r.shift+this.#se)({index:-1,frequency:e.frequency}),this.#de(r,this.#se-t,t)})),e.setValues(o)}#le(){const{granularity:e}=c;return Object.keys(this.axes).map((t=>{const o=this.axes[t],s=30/e,r={axis:t,value:o.motion(o.$current.from,o.$current.to,o.phase,o.ecc,this.#re,o.shift+this.#se),duration:s/this.#re};return this.#de(o,this.#se,Math.PI/c.granularity),r}))}#de(e,t,o){if(e.noise){const{PI:s}=Math,r=e=>180*e/s,a=t=>(0,n.BP)(e.noise)?e.noise:e.noise[t]||0,i=e.phase*s/2+e.shift+t,c=Math.round(r(i%(2*s))),h=Math.round(c+r(o)),p=c<180&&h>=180;if(c<360&&h>=360){const t=a("to"),o=(e.from-e.to)/2;e.$current.to=e.to+t*o*Math.random()}else if(p){const t=a("from"),o=(e.to-e.from)/2;e.$current.from=e.from+t*o*Math.random()}}}#pe(e){if((0,n.e$)(e,"noise")){const{noise:t}=e,o=e=>{throw new Error(`Invalid noise: ${e}`)},s="object"==typeof t;s&&(0,n.e$)(t,"from")&&!(0,n.BP)(t.from,0,1)&&o(t.from),s&&(0,n.e$)(t,"to")&&!(0,n.BP)(t.to,0,1)&&o(t.to),s||(0,n.BP)(t,0,1)||o(t)}}}class h extends c{#D;#_e;#be;#ve;constructor(e,t,o,s,r,a){super(e,t,0,o.timer,o.startTime),this.angle=p.computeTransitionStartAngle(o,s,this.bpm),this.startAngle=this.angle;const i=(o.angle-o.startAngle)/(2*o.bpm*Math.PI/60);this.startTime+=i+s,this.#_e=new p(o,this,s),this.#D=e,this.#be=r,this.#ve=a,o.ayva&&(this.bind(o.ayva),this.#_e.bind(o.ayva))}*generate(e){this.#_e.complete||(this.#be instanceof Function&&this.#be(this.#_e.duration,this.bpm),yield*this.#_e(),this.#ve instanceof Function&&this.#ve(this.#D,this.bpm)),yield*super.generate(e)}}class p extends s.Z{#ge;#ye;#N;get duration(){return this.#N}constructor(e,t,o){super(),this.#ge=e,this.#ye=t,this.#N=o}*generate(e){if(!(e instanceof r.Z))throw new TypeError(`Invalid Ayva instance: ${e}`);const t={...c.DEFAULT_PARAMETERS,from:.5,to:.5,$current:{from:.5,to:.5}},o={...c.DEFAULT_PARAMETERS,from:0,to:0,$current:{from:0,to:0}},s=this.#xe(this.#ge.axes,e),a=this.#xe(this.#ye.axes,e),i={};Object.keys(a).forEach((r=>{const n="auxiliary"===e.getAxis(r).type?o:t,c=s[r]??{...n},h=a[r];i[r]=this.#we(c,h)})),Object.keys(s).forEach((r=>{if(!i[r]){const a="auxiliary"===e.getAxis(r).type?o:t,n=s[r],c={...a};i[r]=this.#we(n,c)}}));const n=[];Object.keys(i).forEach((e=>{n.push({axis:e,...i[e]})})),yield n,this.complete=!0}#we(e,t){const o=this.#ge.bpm,s=(this.#ge.bpm+this.#ye.bpm)/2;return{value:a=>{const{x:i}=a,n=r.Z.map(i,0,1,e.$current.from,t.$current.from),c=r.Z.map(i,0,1,e.$current.to,t.$current.to),h=r.Z.map(i,0,1,e.phase,t.phase),p=r.Z.map(i,0,1,e.ecc,t.ecc),u=r.Z.map(i,0,1,o,s);return r.Z.blendMotion(e.motion(n,c,h,p,u,this.#ge.angle),t.motion(n,c,h,p,u,this.#ge.angle),i)(a)},duration:this.#N}}#xe(e,t){return Object.keys(e).reduce(((o,s)=>(o[t.getAxis(s).name]=e[s],o)),{})}static computeTransitionStartAngle(e,t,o){const s=(e.bpm+o)/2;return e.angle+2*Math.PI*(s/60)*t}}const u=c},336:(e,t,o)=>{o.d(t,{Z:()=>s});const s=class{#X;#Re=[];constructor(e){this.#X=e,Object.values(e.axes).forEach((e=>{this[e.name]=this.#Le(e.name),e.alias&&(this[e.alias]=this.#Le(e.alias))}))}execute(){return this.#X.move(...this.#Re)}#Le(e){return(...t)=>{if(3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"function"==typeof t[2])this.#Re.push({axis:e,to:t[0],duration:t[1],value:t[2]});else if(2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])this.#Re.push({axis:e,to:t[0],duration:t[1]});else if(2===t.length&&"number"==typeof t[0]&&"function"==typeof t[1])this.#Re.push({axis:e,to:t[0],value:t[1]});else if(1===t.length&&"number"==typeof t[0])this.#Re.push({axis:e,to:t[0]});else if(2===t.length&&"function"==typeof t[0]&&"number"==typeof t[1])this.#Re.push({axis:e,value:t[0],duration:t[1]});else if(1===t.length&&"function"==typeof t[0])this.#Re.push({axis:e,value:t[0]});else{if(1!==t.length||"object"!=typeof t[0])throw new Error(`Invalid arguments: ${t}`);this.#Re.push({...t[0],axis:e})}return this}}}},424:(e,t,o)=>{o.r(t),o.d(t,{Ayva:()=>s.Z,GeneratorBehavior:()=>r.Z,ClassicStroke:()=>a.Z,TempestStroke:()=>i.Z,VariableDuration:()=>n.Z});var s=o(570),r=o(697),a=o(321),i=o(824),n=o(217)},319:(e,t,o)=>{o.d(t,{Z:()=>s});class s{#Ae=0;#Me;constructor(e){this.#Me=e}next(){return this.#Me(this.#Ae++)}get index(){return this.#Ae}static createFrom(e){return new s(e instanceof Array?t=>e[t%e.length]:"function"!=typeof e?()=>e:e)}}},465:(e,t,o)=>{function s(e,t=0){const o=10**t;return Math.round(o*e)/o}function r(e,t,o){return Math.max(t,Math.min(o,e))}function a(e,t,o){return!(!Number.isFinite(e)||void 0!==t&&e<t||void 0!==o&&e>o)}function i(e,t,o){Object.defineProperty(e,t,{value:o,writeable:!1,configurable:!1,enumerable:!0})}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e){throw new Error(e)}function h(e){return"GeneratorFunction"===e.constructor.name}o.d(t,{NM:()=>s,uZ:()=>r,BP:()=>a,w6:()=>i,e$:()=>n,bG:()=>c,Af:()=>h})},217:(e,t,o)=>{o.d(t,{Z:()=>r});var s=o(465);const r=class{#ie;#Pe;constructor(e,t){if((0,s.BP)(e,0)&&void 0===t)this.#Pe=1e3*e;else{if(!((0,s.BP)(e,0)&&(0,s.BP)(t,0)&&e<t))throw new Error(`Invalid duration range: (${e}, ${t})`);this.#Pe=1e3*(Math.random()*(t-e)+e)}this.#ie=performance.now()}get targetElapsed(){return this.#Pe}get complete(){return performance.now()-this.#ie>=this.#Pe}get percentage(){return(0,s.uZ)((performance.now()-this.#ie)/this.#Pe,0,1)}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.d(__webpack_exports__,{kZ:()=>e.Z,fV:()=>s.Z,we:()=>t.Z,qT:()=>o.Z,ft:()=>r.Z,ni:()=>a.Z,_I:()=>i});var e=__webpack_require__(570),t=__webpack_require__(697),o=__webpack_require__(590),s=__webpack_require__(321),r=__webpack_require__(824),a=__webpack_require__(217);const i=class{connected=!1;_baudRate;_output=null;_input=null;_serial=null;_outputClosedPromise=null;_inputClosedPromise=null;constructor(e=115200,t=null){this._baudRate=e,this._serial=t||(globalThis.navigator?globalThis.navigator.serial:null)}async requestConnection(){const e=await this._serial.requestPort();await e.open({baudRate:this._baudRate});const t=new TextEncoderStream;this._outputClosedPromise=t.readable.pipeTo(e.writable);const o=new TextDecoderStream;this._inputClosedPromise=e.readable.pipeTo(o.writable),this._output=t.writable.getWriter(),this._input=o.readable.getReader(),this._port=e,this.connected=!0;const s=t=>{t.target===e&&(this.connected=!1,this._serial.removeEventListener("disconnect",s))};return this._serial.addEventListener("disconnect",s),new Promise((e=>{setTimeout(e,2e3)}))}async disconnect(){this.connected=!1,this._input.cancel(),this._output.close(),await this._inputClosedPromise.catch((()=>{})),await this._outputClosedPromise,await this._port.close(),this._output=null,this._input=null,this._inputClosedPromise=null,this._outputClosedPromise=null}write(e){if(!this.connected)throw new Error("No device connected.");this._output.write(e)}}})();var __webpack_exports__Ayva=__webpack_exports__.kZ,__webpack_exports__ClassicStroke=__webpack_exports__.fV,__webpack_exports__GeneratorBehavior=__webpack_exports__.we,__webpack_exports__ScriptBehavior=__webpack_exports__.qT,__webpack_exports__TempestStroke=__webpack_exports__.ft,__webpack_exports__VariableDuration=__webpack_exports__.ni,__webpack_exports__WebSerialDevice=__webpack_exports__._I;export{__webpack_exports__Ayva as Ayva,__webpack_exports__ClassicStroke as ClassicStroke,__webpack_exports__GeneratorBehavior as GeneratorBehavior,__webpack_exports__ScriptBehavior as ScriptBehavior,__webpack_exports__TempestStroke as TempestStroke,__webpack_exports__VariableDuration as VariableDuration,__webpack_exports__WebSerialDevice as WebSerialDevice};